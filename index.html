<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crash RAG Composite — United States</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0b0c10; color:#fff; text-align:center; padding:20px; }
    h1 { color:#fff; }
    .crc-box { display:inline-block; padding:20px 40px; border-radius:12px; font-size:22px; font-weight:bold; margin:20px; }
    .loading { background:#444; color:#ff0; }
    .green { background:#006400; color:#fff; }
    .amber { background:#ff8c00; color:#fff; }
    .red { background:#8b0000; color:#fff; }
  </style>
</head>
<body>
  <h1>Crash RAG Composite — United States</h1>
  <div id="crc" class="crc-box loading">CRC: Loading...</div>

  <script>
    const API_KEY = "b78d7171c0fc257622597099f88fa7f7";  // your FRED API key
    const seriesIds = [
      "UNRATE",     // Unemployment rate
      "CPIAUCSL",   // CPI
      "SP500",      // S&P 500 index
      "T10Y2Y"      // 10Y-2Y Treasury spread
    ];

    async function fetchSeries(seriesId) {
      const url = `https://api.stlouisfed.org/fred/series/observations?series_id=${seriesId}&api_key=${API_KEY}&file_type=json`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data && data.observations) {
          let last = data.observations[data.observations.length - 1].value;
          return parseFloat(last);
        }
      } catch (e) {
        console.error("Fetch error:", e);
      }
      return null;
    }

    async function runCRC() {
      const crcBox = document.getElementById("crc");
      crcBox.textContent = "CRC: Loading...";

      let values = [];
      for (let id of seriesIds) {
        let val = await fetchSeries(id);
        if (val) values.push(val);
      }

      if (values.length === 0) {
        crcBox.textContent = "CRC: Error fetching data";
        crcBox.className = "crc-box red";
        return;
      }

      // Naive composite risk score
      let score = values.reduce((a,b) => a+b, 0) / values.length;

      // Fake thresholds just for demo
      if (score < 50) {
        crcBox.textContent = "CRC: GREEN";
        crcBox.className = "crc-box green";
      } else if (score < 150) {
        crcBox.textContent = "CRC: AMBER";
        crcBox.className = "crc-box amber";
      } else {
        crcBox.textContent = "CRC: RED";
        crcBox.className = "crc-box red";
      }
    }

    runCRC();
  </script>
</body>
</html>
